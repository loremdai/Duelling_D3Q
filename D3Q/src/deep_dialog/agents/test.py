import torch
from torch.distributions import Categorical

probs = torch.FloatTensor([[0.0557, 0.0296, 0.1242, 0.0795, 0.0192, 0.0156, 0.0106, 0.0360, 0.0386,
                            0.0310, 0.0831, 0.0731, 0.0064, 0.0434, 0.0182, 0.0087, 0.0391, 0.0154,
                            0.0206, 0.0168, 0.0167, 0.0804, 0.0172, 0.0054, 0.0160, 0.0096, 0.0087,
                            0.0103, 0.0305, 0.0343, 0.0057],
                           [0.0438, 0.0308, 0.0712, 0.0477, 0.0266, 0.0247, 0.0179, 0.0368, 0.0386,
                            0.0346, 0.0785, 0.0559, 0.0119, 0.0392, 0.0252, 0.0166, 0.0349, 0.0201,
                            0.0325, 0.0272, 0.0233, 0.0595, 0.0247, 0.0120, 0.0195, 0.0188, 0.0149,
                            0.0224, 0.0369, 0.0402, 0.0132],
                           [0.0386, 0.0375, 0.0548, 0.0419, 0.0303, 0.0247, 0.0219, 0.0347, 0.0385,
                            0.0325, 0.0531, 0.0438, 0.0199, 0.0365, 0.0308, 0.0217, 0.0353, 0.0244,
                            0.0346, 0.0311, 0.0306, 0.0418, 0.0290, 0.0194, 0.0262, 0.0236, 0.0220,
                            0.0283, 0.0356, 0.0396, 0.0173],
                           [0.0514, 0.0373, 0.1061, 0.0707, 0.0224, 0.0168, 0.0133, 0.0356, 0.0397,
                            0.0319, 0.0661, 0.0636, 0.0095, 0.0426, 0.0227, 0.0118, 0.0424, 0.0183,
                            0.0241, 0.0195, 0.0216, 0.0677, 0.0218, 0.0088, 0.0208, 0.0130, 0.0119,
                            0.0135, 0.0319, 0.0354, 0.0079],
                           [0.0391, 0.0370, 0.0544, 0.0424, 0.0303, 0.0246, 0.0211, 0.0341, 0.0397,
                            0.0323, 0.0550, 0.0439, 0.0197, 0.0373, 0.0312, 0.0214, 0.0352, 0.0242,
                            0.0347, 0.0319, 0.0305, 0.0406, 0.0280, 0.0193, 0.0258, 0.0231, 0.0217,
                            0.0281, 0.0360, 0.0409, 0.0168],
                           [0.0438, 0.0321, 0.0755, 0.0486, 0.0265, 0.0242, 0.0178, 0.0370, 0.0391,
                            0.0338, 0.0771, 0.0543, 0.0119, 0.0386, 0.0255, 0.0162, 0.0357, 0.0195,
                            0.0328, 0.0275, 0.0241, 0.0592, 0.0242, 0.0121, 0.0197, 0.0187, 0.0148,
                            0.0219, 0.0360, 0.0391, 0.0127],
                           [0.0519, 0.0306, 0.1349, 0.0742, 0.0173, 0.0144, 0.0104, 0.0370, 0.0376,
                            0.0364, 0.0808, 0.0696, 0.0056, 0.0441, 0.0173, 0.0071, 0.0432, 0.0148,
                            0.0211, 0.0165, 0.0156, 0.0881, 0.0165, 0.0050, 0.0141, 0.0088, 0.0077,
                            0.0100, 0.0291, 0.0348, 0.0053],
                           [0.0432, 0.0335, 0.0779, 0.0514, 0.0257, 0.0234, 0.0169, 0.0357, 0.0411,
                            0.0327, 0.0804, 0.0517, 0.0116, 0.0396, 0.0261, 0.0151, 0.0360, 0.0177,
                            0.0342, 0.0293, 0.0248, 0.0587, 0.0224, 0.0120, 0.0197, 0.0187, 0.0140,
                            0.0216, 0.0337, 0.0395, 0.0118],
                           [0.0661, 0.0213, 0.1368, 0.1202, 0.0157, 0.0103, 0.0050, 0.0273, 0.0394,
                            0.0225, 0.1084, 0.0948, 0.0037, 0.0507, 0.0136, 0.0052, 0.0340, 0.0109,
                            0.0136, 0.0118, 0.0110, 0.0735, 0.0108, 0.0027, 0.0129, 0.0057, 0.0048,
                            0.0051, 0.0271, 0.0323, 0.0026],
                           [0.0421, 0.0392, 0.0682, 0.0508, 0.0291, 0.0228, 0.0178, 0.0337, 0.0407,
                            0.0298, 0.0601, 0.0473, 0.0174, 0.0383, 0.0323, 0.0191, 0.0370, 0.0232,
                            0.0309, 0.0297, 0.0305, 0.0414, 0.0253, 0.0172, 0.0257, 0.0214, 0.0195,
                            0.0227, 0.0356, 0.0371, 0.0140],
                           [0.0558, 0.0219, 0.1066, 0.0693, 0.0181, 0.0167, 0.0095, 0.0359, 0.0382,
                            0.0365, 0.1091, 0.0849, 0.0049, 0.0469, 0.0155, 0.0077, 0.0364, 0.0151,
                            0.0200, 0.0168, 0.0131, 0.0866, 0.0154, 0.0042, 0.0118, 0.0084, 0.0071,
                            0.0105, 0.0326, 0.0390, 0.0056],
                           [0.0385, 0.0376, 0.0526, 0.0416, 0.0307, 0.0246, 0.0220, 0.0340, 0.0388,
                            0.0321, 0.0518, 0.0431, 0.0207, 0.0365, 0.0313, 0.0223, 0.0349, 0.0248,
                            0.0345, 0.0314, 0.0310, 0.0401, 0.0292, 0.0202, 0.0268, 0.0238, 0.0227,
                            0.0288, 0.0357, 0.0401, 0.0176],
                           [0.0546, 0.0239, 0.1073, 0.0680, 0.0191, 0.0169, 0.0102, 0.0365, 0.0389,
                            0.0367, 0.1002, 0.0809, 0.0056, 0.0462, 0.0167, 0.0083, 0.0381, 0.0160,
                            0.0210, 0.0178, 0.0144, 0.0820, 0.0163, 0.0049, 0.0130, 0.0091, 0.0080,
                            0.0111, 0.0332, 0.0390, 0.0061],
                           [0.0661, 0.0213, 0.1368, 0.1202, 0.0157, 0.0103, 0.0050, 0.0273, 0.0394,
                            0.0225, 0.1084, 0.0948, 0.0037, 0.0507, 0.0136, 0.0052, 0.0340, 0.0109,
                            0.0136, 0.0118, 0.0110, 0.0735, 0.0108, 0.0027, 0.0129, 0.0057, 0.0048,
                            0.0051, 0.0271, 0.0323, 0.0026],
                           [0.0661, 0.0213, 0.1368, 0.1202, 0.0157, 0.0103, 0.0050, 0.0273, 0.0394,
                            0.0225, 0.1084, 0.0948, 0.0037, 0.0507, 0.0136, 0.0052, 0.0340, 0.0109,
                            0.0136, 0.0118, 0.0110, 0.0735, 0.0108, 0.0027, 0.0129, 0.0057, 0.0048,
                            0.0051, 0.0271, 0.0323, 0.0026],
                           [0.0670, 0.0185, 0.1260, 0.1222, 0.0153, 0.0108, 0.0045, 0.0254, 0.0383,
                            0.0207, 0.1305, 0.0983, 0.0033, 0.0513, 0.0134, 0.0052, 0.0297, 0.0102,
                            0.0133, 0.0119, 0.0100, 0.0725, 0.0099, 0.0023, 0.0117, 0.0057, 0.0043,
                            0.0050, 0.0278, 0.0325, 0.0025]])

probs2 = torch.FloatTensor([0.0557, 0.0296, 0.1242, 0.0795, 0.0192, 0.0156, 0.0106, 0.0360, 0.0386,
                            0.0310, 0.0831, 0.0731, 0.0064, 0.0434, 0.0182, 0.0087, 0.0391, 0.0154,
                            0.0206, 0.0168, 0.0167, 0.0804, 0.0172, 0.0054, 0.0160, 0.0096, 0.0087,
                            0.0103, 0.0305, 0.0343, 0.0057])
actions_argmax = torch.argmax(probs2).item()
print("actions_argmax: ")
print(actions_argmax)
print("\n")

max, indices = torch.max(probs, dim=1)
log=torch.log(max)

print(indices)
print("max: ")
print(max)
print("log: ")
print(log)
print("\n")

dist = Categorical(probs=probs)
actions = dist.sample()
log_prob = dist.log_prob(actions)
print(actions)

print(log_prob)